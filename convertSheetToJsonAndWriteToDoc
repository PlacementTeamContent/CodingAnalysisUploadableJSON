function convertSheetToJsonAndWriteToDoc() {
  // Get active spreadsheet and the first sheet
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheets()[17];
 
  // Get all data in the sheet
  var data = sheet.getDataRange().getValues();
 
  // Extract the headers
  var headers = data[0];
 
  // Initialize an array to hold the JSON objects
  var jsonArray = [];
 
  // Loop through the rows and create JSON objects
  for (var i = 1; i < data.length; i++) {
    var row = data[i];
    var jsonObject = {};
   
    for (var j = 0; j < headers.length; j++) {
      jsonObject[headers[j]] = row[j];
    }
   
    jsonArray.push(jsonObject);
  }
 
  // Convert the array of JSON objects to a JSON string
  var json = JSON.stringify(jsonArray, null, 2);
 
  // Create a new Google Doc
  var doc = DocumentApp.create('Sheet Data as JSON');
 
  // Write the JSON string to the Google Doc
  doc.getBody().appendParagraph(json);
 
  // Log the URL of the new document
  Logger.log('Document URL: ' + doc.getUrl());
}
